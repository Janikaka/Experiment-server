API-info:
  type: object
  required:
    - version
    - description
  properties:
    version:
      type: string
    description:
      type: string

Application:
  type: object
  allOf:
    - $ref: '#/definitions/NewApplication'
    - required:
      - id
      properties:
        id:
          type: integer
        experiments:
          type: array
          items:
            $ref: "#/definitions/Experiment"
        configurationkeys:
          type: array
          items:
            $ref: "#/definitions/ConfigurationKey"

NewApplication:
  type: object
  required:
    - name
  properties:
    name:
      type: string

ConfigurationKey:
  type: object
  allOf:
    - $ref: '#/definitions/NewConfigurationKey'
    - required:
      - id
      properties:
        id:
          type: integer
        rangeconstraints:
          type: array
          items:
            $ref: "#/definitions/RangeConstraint"

NewConfigurationKey:
  type: object
  required:
    - name
    - type
  properties:
    name:
      type: string
    type:
      type: string
    application_id:
      type: integer

Configuration:
  type: object
  required:
    - id
    - experimentgroup_id
    - key
    - value
  properties:
    id:
      type: integer
    experimentgroup_id:
      type: integer
    key:
      type: string
    value:
      type:
        - integer
        - string
        - boolean

DataItem:
  type: object
  required:
    - id
  properties:
    id:
      type: integer
    client_id:
      type: integer
    key:
      type: string
    value:
      type:
        - integer
        - string
        - boolean
    startDateTime:
      type: string
    endDateTime:
      type: string

ExclusionConstraint:
  type: object
  required:
    - id
    - first_configurationkey_id
    - first_operator_id
    - second_configurationkey_id
  properties:
    id:
      type: integer
    first_configurationkey_id:
      type: integer
    first_operator_id:
      type: integer
    first_value_a:
      type:
        - string
        - "null"
    first_value_b:
      type:
        - string
        - "null"
    second_configurationkey_id:
      type: integer
    second_operator_id:
      type:
        - integer
        - "null"
    second_value_a:
      type:
        - string
        - "null"
    second_value_b:
      type:
        - string
        - "null"

ExperimentGroup:
  type: object
  required:
    - id
  properties:
    id:
      type: integer
    experiment_id:
      type: integer
    name:
      type: string
    configurations:
      type: array
      items:
        $ref: "#/definitions/Configuration"
    clients:
      type: array
      items:
        $ref: "#/definitions/Client"


Experiment:
  type: object
  required:
    - id
  properties:
    id:
      type: integer
    application_id:
      type: integer
    name:
      type: string
    startDatetime:
      type: string
      format: date-time
    endDatetime:
      type: string
      format: date-time
    experimentgroups:
      type: array
      items:
        $ref: "#/definitions/ExperimentGroup"
    size:
      type: integer

NewExperiment:
  type: object
  required:
    - name
    - application_id
    - startDatetime
    - endDatetime
    - size
  properties:
    application_id:
      type: integer
    name:
      type: string
    startDatetime:
      type: string
      format: date-time
    endDatetime:
      type: string
      format: date-time
    size:
      type: integer

Operator:
  type: object
  required:
    - id
  properties:
    id:
      type: integer
    math_value:
      type: string
    human_value:
      type: string
    rangeconstraints:
      type: array
      items:
        $ref: "#/definitions/RangeConstraint"

RangeConstraint:
  type: object
  allOf:
    - $ref: '#/definitions/NewRangeConstraint'
    - required:
      - id
      properties:
        id:
          type: integer

NewRangeConstraint:
  type: object
  required:
    - value
  properties:
    configurationkey_id:
      type: integer
    operator_id:
      type: integer
    value:
      type: integer

Client:
  allOf:
    - $ref: '#/definitions/NewClient'
    - type: object
      required:
      - id
      properties:
        id:
          type: integer
        dataitems:
          type: array
          items:
            $ref: "#/definitions/DataItem"
        experimentgroups:
          type: array
          items:
            $ref: "#/definitions/ExperimentGroup"

NewClient:
  type: object
  required:
    - clientname
  properties:
    clientname:
      type: string
